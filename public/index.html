<!DOCTYPE html>
<html>

<head>
    <title>Video Downloader</title>
    <script>
        async function downloadVideo(event) {
            event.preventDefault();

            const urlInput = document.querySelector('#url');
            const formatIdInput = document.querySelector('#formatId');

            const url = urlInput.value;
            const formatId = formatIdInput.value;

            // Need to Validate and sanitize the input

            const response = await fetch('/download', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ url, formatId }),
            });

            if (!response.ok) {
                console.error('An error occurred while downloading the video.');
            } else {
                const data = await response.json();
                console.log(data);

                // Provide a download link
                const downloadLink = document.createElement('a');
                downloadLink.href = data.downloadUrl;
                downloadLink.innerText = 'Download Video';
                document.body.appendChild(downloadLink);
            }


            urlInput.value = '';
            formatIdInput.value = '';
        }
    </script>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <h1>Kick Vlog Downloader</h1>
    <form onsubmit="downloadVideo(event)">
        <label for="url">Stream URL:</label><br>
        <input type="text" id="url" name="url" required><br>
        <label for="formatId">Format ID (optional):</label><br>
        <input type="text" id="formatId" name="formatId"><br>
        <button type="submit" class="download-button">â¬‡ Download</button>
    </form>
</body>

</html>